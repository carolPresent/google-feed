{"version":3,"sources":["../user-service.js"],"names":["Repository","require","Database","saveLoginDetails","data","newTokenModel","AccessToken","access_token","RefreshToken","refresh_token","Scope","scope","TokenType","token_type","IdToken","id_token","ExpiryDate","expiry_date","saveOne","token","getOne","User","Id","id","Email","email","user","newUserModel","Token","_id","deleteMany","save","module","exports","SaveLoginDetails"],"mappings":";;;;AAAA,IAAIA,aAAWC,QAAQ,eAAR,CAAf;AACA,IAAIC,WAASD,QAAQ,YAAR,CAAb;;AAEA,IAAIE;AAAA,uEAAiB,iBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbC,qCAFa,GAEC;AACdC,yCAAYF,KAAKG,YADH;AAEdC,0CAAaJ,KAAKK,aAFJ;AAGdC,mCAAMN,KAAKO,KAHG;AAIdC,uCAAUR,KAAKS,UAJD;AAKdC,qCAAQV,KAAKW,QALC;AAMdC,wCAAWZ,KAAKa;AANF,yBAFD;AAAA;AAAA,+BAWCjB,WAAWkB,OAAX,CAAmBb,aAAnB,CAXD;;AAAA;AAWbc,6BAXa;AAAA;AAAA,+BAaDnB,WAAWoB,MAAX,CAAkBlB,SAASmB,IAA3B,EAAgC,EAACC,IAAGlB,KAAKmB,EAAT,EAAYC,OAAMpB,KAAKqB,KAAvB,EAAhC,CAbC;;AAAA;AAabC,4BAba;;AAAA,8BAedA,QAAM,IAfQ;AAAA;AAAA;AAAA;;AAiBTC,oCAjBS,GAiBI;AACbL,gCAAGlB,KAAKmB,EADK;AAEbC,mCAAMpB,KAAKqB,KAFE;AAGbG,mCAAMT,MAAMU;AAHC,yBAjBJ;AAAA;AAAA,+BAuBP7B,WAAWkB,OAAX,CAAmBS,YAAnB,CAvBO;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,+BA2BP3B,WAAW8B,UAAX,CAAsB5B,SAAS0B,KAA/B,EAAqC,EAACC,KAAIH,KAAKE,KAAV,EAArC,CA3BO;;AAAA;;AA6BbF,6BAAKE,KAAL,GAAWT,MAAMU,GAAjB;;AA7Ba;AAAA,+BA+BPH,KAAKK,IAAL,EA/BO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAjB;;AAAA;AAAA;AAAA;AAAA,GAAJ;;AAqCAC,OAAOC,OAAP,GAAe;AACXC,sBAAiB/B;AADN,CAAf","file":"user-service.js","sourcesContent":["var Repository=require('./dbfunctions');\nvar Database=require('./database');\n\nvar saveLoginDetails=async (data)=>{\n\n    var newTokenModel={\n        AccessToken:data.access_token,\n        RefreshToken:data.refresh_token,\n        Scope:data.scope,\n        TokenType:data.token_type,\n        IdToken:data.id_token,\n        ExpiryDate:data.expiry_date\n    };\n\n    let token = await Repository.saveOne(newTokenModel);\n\n    let user= await Repository.getOne(Database.User,{Id:data.id,Email:data.email});\n\n    if(user==null){\n\n        let newUserModel={\n            Id:data.id,\n            Email:data.email,\n            Token:token._id\n        };\n\n        await Repository.saveOne(newUserModel);\n\n    }else{\n\n        await Repository.deleteMany(Database.Token,{_id:user.Token});\n\n        user.Token=token._id;\n\n        await user.save();\n\n    }\n    \n}\n\nmodule.exports={\n    SaveLoginDetails:saveLoginDetails\n}"]}