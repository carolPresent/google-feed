{"version":3,"sources":["../user-service.js"],"names":["Repository","require","Database","saveLoginDetails","data","newTokenModel","Token","AccessToken","access_token","RefreshToken","refresh_token","Scope","scope","TokenType","token_type","IdToken","id_token","ExpiryDate","expiry_date","saveOne","token","getOne","User","Id","id","Email","email","user","console","log","newUserModel","_id","deleteMany","save","module","exports","SaveLoginDetails"],"mappings":";;;;AAAA,IAAIA,aAAWC,QAAQ,eAAR,CAAf;AACA,IAAIC,WAASD,QAAQ,YAAR,CAAb;;AAEA,IAAIE;AAAA,uEAAiB,iBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbC,qCAFa,GAEC,IAAIH,SAASI,KAAb,CAAmB;AACjCC,yCAAYH,KAAKI,YADgB;AAEjCC,0CAAaL,KAAKM,aAFe;AAGjCC,mCAAMP,KAAKQ,KAHsB;AAIjCC,uCAAUT,KAAKU,UAJkB;AAKjCC,qCAAQX,KAAKY,QALoB;AAMjCC,wCAAWb,KAAKc;AANiB,yBAAnB,CAFD;AAAA;AAAA,+BAWClB,WAAWmB,OAAX,CAAmBd,aAAnB,CAXD;;AAAA;AAWbe,6BAXa;AAAA;AAAA,+BAaDpB,WAAWqB,MAAX,CAAkBnB,SAASoB,IAA3B,EAAgC,EAACC,IAAGnB,KAAKoB,EAAT,EAAYC,OAAMrB,KAAKsB,KAAvB,EAAhC,CAbC;;AAAA;AAabC,4BAba;;;AAejBC,gCAAQC,GAAR,CAAYF,IAAZ;AACAC,gCAAQC,GAAR,CAAYT,KAAZ;;AAhBiB,8BAkBdO,QAAM,IAlBQ;AAAA;AAAA;AAAA;;AAoBTG,oCApBS,GAoBI,IAAI5B,SAASoB,IAAb,CAAkB;AAC/BC,gCAAGnB,KAAKoB,EADuB;AAE/BC,mCAAMrB,KAAKsB,KAFoB;AAG/BpB,mCAAMc,MAAMW;AAHmB,yBAAlB,CApBJ;AAAA;AAAA,+BA0BP/B,WAAWmB,OAAX,CAAmBW,YAAnB,CA1BO;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,+BA8BP9B,WAAWgC,UAAX,CAAsB9B,SAASI,KAA/B,EAAqC,EAACyB,KAAIJ,KAAKrB,KAAV,EAArC,CA9BO;;AAAA;;AAgCbqB,6BAAKrB,KAAL,GAAWc,MAAMW,GAAjB;;AAhCa;AAAA,+BAkCPJ,KAAKM,IAAL,EAlCO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAjB;;AAAA;AAAA;AAAA;AAAA,GAAJ;;AAwCAC,OAAOC,OAAP,GAAe;AACXC,sBAAiBjC;AADN,CAAf","file":"user-service.js","sourcesContent":["var Repository=require('./dbfunctions');\nvar Database=require('./database');\n\nvar saveLoginDetails=async (data)=>{\n\n    var newTokenModel=new Database.Token({\n        AccessToken:data.access_token,\n        RefreshToken:data.refresh_token,\n        Scope:data.scope,\n        TokenType:data.token_type,\n        IdToken:data.id_token,\n        ExpiryDate:data.expiry_date\n    });\n\n    let token = await Repository.saveOne(newTokenModel);\n\n    let user= await Repository.getOne(Database.User,{Id:data.id,Email:data.email});\n\n    console.log(user);\n    console.log(token);\n\n    if(user==null){\n\n        let newUserModel=new Database.User({\n            Id:data.id,\n            Email:data.email,\n            Token:token._id\n        });\n\n        await Repository.saveOne(newUserModel);\n\n    }else{\n\n        await Repository.deleteMany(Database.Token,{_id:user.Token});\n\n        user.Token=token._id;\n\n        await user.save();\n\n    }\n    \n}\n\nmodule.exports={\n    SaveLoginDetails:saveLoginDetails\n}"]}