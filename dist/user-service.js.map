{"version":3,"sources":["../user-service.js"],"names":["Repository","require","Database","saveLoginDetails","data","newTokenModel","AccessToken","access_token","RefreshToken","refresh_token","Scope","scope","TokenType","token_type","IdToken","id_token","ExpiryDate","expiry_date","saveOne","token","getOne","User","Id","id","Email","email","user","console","log","newUserModel","Token","_id","deleteMany","save","module","exports","SaveLoginDetails"],"mappings":";;;;AAAA,IAAIA,aAAWC,QAAQ,eAAR,CAAf;AACA,IAAIC,WAASD,QAAQ,YAAR,CAAb;;AAEA,IAAIE;AAAA,uEAAiB,iBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbC,qCAFa,GAEC;AACdC,yCAAYF,KAAKG,YADH;AAEdC,0CAAaJ,KAAKK,aAFJ;AAGdC,mCAAMN,KAAKO,KAHG;AAIdC,uCAAUR,KAAKS,UAJD;AAKdC,qCAAQV,KAAKW,QALC;AAMdC,wCAAWZ,KAAKa;AANF,yBAFD;AAAA;AAAA,+BAWCjB,WAAWkB,OAAX,CAAmBb,aAAnB,CAXD;;AAAA;AAWbc,6BAXa;AAAA;AAAA,+BAaDnB,WAAWoB,MAAX,CAAkBlB,SAASmB,IAA3B,EAAgC,EAACC,IAAGlB,KAAKmB,EAAT,EAAYC,OAAMpB,KAAKqB,KAAvB,EAAhC,CAbC;;AAAA;AAabC,4BAba;;;AAejBC,gCAAQC,GAAR,CAAYF,IAAZ;AACAC,gCAAQC,GAAR,CAAYT,KAAZ;;AAhBiB,8BAkBdO,QAAM,IAlBQ;AAAA;AAAA;AAAA;;AAoBTG,oCApBS,GAoBI;AACbP,gCAAGlB,KAAKmB,EADK;AAEbC,mCAAMpB,KAAKqB,KAFE;AAGbK,mCAAMX,MAAMY;AAHC,yBApBJ;AAAA;AAAA,+BA0BP/B,WAAWkB,OAAX,CAAmBW,YAAnB,CA1BO;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,+BA8BP7B,WAAWgC,UAAX,CAAsB9B,SAAS4B,KAA/B,EAAqC,EAACC,KAAIL,KAAKI,KAAV,EAArC,CA9BO;;AAAA;;AAgCbJ,6BAAKI,KAAL,GAAWX,MAAMY,GAAjB;;AAhCa;AAAA,+BAkCPL,KAAKO,IAAL,EAlCO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAjB;;AAAA;AAAA;AAAA;AAAA,GAAJ;;AAwCAC,OAAOC,OAAP,GAAe;AACXC,sBAAiBjC;AADN,CAAf","file":"user-service.js","sourcesContent":["var Repository=require('./dbfunctions');\nvar Database=require('./database');\n\nvar saveLoginDetails=async (data)=>{\n\n    var newTokenModel={\n        AccessToken:data.access_token,\n        RefreshToken:data.refresh_token,\n        Scope:data.scope,\n        TokenType:data.token_type,\n        IdToken:data.id_token,\n        ExpiryDate:data.expiry_date\n    };\n\n    let token = await Repository.saveOne(newTokenModel);\n\n    let user= await Repository.getOne(Database.User,{Id:data.id,Email:data.email});\n\n    console.log(user);\n    console.log(token);\n\n    if(user==null){\n\n        let newUserModel={\n            Id:data.id,\n            Email:data.email,\n            Token:token._id\n        };\n\n        await Repository.saveOne(newUserModel);\n\n    }else{\n\n        await Repository.deleteMany(Database.Token,{_id:user.Token});\n\n        user.Token=token._id;\n\n        await user.save();\n\n    }\n    \n}\n\nmodule.exports={\n    SaveLoginDetails:saveLoginDetails\n}"]}